<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leer Excel y Mostrar en Div</title>
    <style>
        body {
  background-color: rgba(120, 12, 12, 90);
}

body {
            font-family: Arial, sans-serif;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f4f4f4;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>

  <select id="sheet-select" style="display: none;"></select>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <script>
        let workbook;

    async function fetchReadExcel() {
    try {
        const response = await fetch('fixture.xlsx');
        const arrayBuffer = await response.arrayBuffer();
        const data = new Uint8Array(arrayBuffer);
        workbook = XLSX.read(data, { type: 'array' });

        // Llenar el selector de hojas
        const sheetSelect = document.getElementById('sheet-select');
        sheetSelect.innerHTML = '';
        workbook.SheetNames.forEach((sheetName, index) => {
            if ( sheetName != "Table 1"){
              const option = document.createElement('option');
            option.value = index;
            option.textContent = sheetName;
            sheetSelect.appendChild(option);
          }
        });
        sheetSelect.style.display = 'block';

        // Mostrar la primera hoja por defecto (opcional)
        if (workbook.SheetNames.length > 1) {
            sheetSelect.selectedIndex = 1;
            displayFixture(XLSX.utils.sheet_to_json(workbook.Sheets[workbook.SheetNames[1]]));
        }
    } catch (error) {
        console.error('Error reading Excel file:', error);
    }
}

function handleSheetChange(e) {
    const sheetIndex = e.target.value;
    const sheetName = workbook.SheetNames[sheetIndex];
    const worksheet = workbook.Sheets[sheetName];
    const json = XLSX.utils.sheet_to_json(worksheet);
    displayFixture(json);
}

function displayFixture(data) {
    const outputDiv = document.getElementById('output-div');
    outputDiv.innerHTML = '';

    const table = document.createElement('table');
    const thead = document.createElement('thead');
    const tbody = document.createElement('tbody');

    // Crear encabezados de tabla
    if (data.length > 1) {
        const headers = Object.keys(data[1]);
        const trHead = document.createElement('tr');
        headers.forEach(header => {
            const th = document.createElement('th');
            th.textContent = header;
            trHead.appendChild(th);
        });
        thead.appendChild(trHead);

        // Crear filas de datos
        data.forEach(row => {
            const tr = document.createElement('tr');
            headers.forEach(header => {
                const td = document.createElement('td');
                td.textContent = row[header];
                tr.appendChild(td);
            });
            tbody.appendChild(tr);
        });

        table.appendChild(thead);
        table.appendChild(tbody);
        outputDiv.appendChild(table);
    } else {
        outputDiv.textContent = 'No data available in the selected sheet.';
    }
}

document.getElementById('sheet-select').addEventListener('change', handleSheetChange, false);

// Call the function when the page loads
fetchReadExcel();
       
</script>
    
    
    <div id="output-div">
        
      </div>
     

    
</body>
</html>
